USE DATASUS;

LOAD DATA LOCAL INFILE '/data/load/pobr/pobr.csv'
     INTO TABLE POBR
     FIELDS TERMINATED BY ','
     ENCLOSED BY '"'
     LINES TERMINATED BY '\n'
     IGNORE 1 ROWS
     (`ANO_DIAGN`, `ANOMES_DIA`, `ANO_TRATAM`, `ANOMES_TRA`, `UF_RESID`,
     `MUN_RESID`, `UF_TRATAM`, `MUN_TRATAM`, `UF_DIAGN`, `MUN_DIAG`,
     `TRATAMENTO`, `DIAGNOSTIC`, `IDADE`, `SEXO`, `ESTADIAM`, `CNES_DIAG`,
     `CNES_TRAT`, `TEMPO_TRAT`, `CNS_PAC`, `DIAG_DETH`, `DT_DIAG`, `DT_TRAT`,
     `DT_NASC`);

ALTER TABLE POBR ADD ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY;

ALTER TABLE POBR MODIFY COLUMN ESTADIAM ENUM('0', '1', '2', '3', '4', '5', '9', 'I', 'II', 'III', 'IV', 'N/A', 'Ignorado');
UPDATE POBR SET ESTADIAM = 'I' WHERE ESTADIAM = '1';
UPDATE POBR SET ESTADIAM = 'II' WHERE ESTADIAM = '2';
UPDATE POBR SET ESTADIAM = 'III' WHERE ESTADIAM = '3';
UPDATE POBR SET ESTADIAM = 'IV' WHERE ESTADIAM = '4';
UPDATE POBR SET ESTADIAM = 'N/A' WHERE ESTADIAM = '5';
UPDATE POBR SET ESTADIAM = 'Ignorado' WHERE ESTADIAM = '9';
ALTER TABLE POBR MODIFY COLUMN ESTADIAM ENUM('0', 'I', 'II', 'III', 'IV', 'N/A', 'Ignorado');
